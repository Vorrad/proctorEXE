# 接口定义文件

## 接口定义

定义模块间接口

### 用户态应用接口

| 接口               | 描述                    | 返回     |
| ------------------ | ----------------------- | -------- |
| isAdmin(uid)       | 判断是否为管理员        | 判断结果 |
| showRules()        | 显示当前策略集          |          |
| addRule(rule)      | 添加策略                | 1*       |
| delRule(rule)      | 删除相应策略            | 1*       |
| modRule(rid, rule) | 修改策略，rid为策略编号 | 1*       |
| showLog()          | 显示程序审计日志        |          |

### 内核接口

| 接口                      | 描述                                                        | 返回         |
| ------------------------- | ----------------------------------------------------------- | ------------ |
| admissionReq(pid, action) | 利用netlink向程序权限数据库发送查询，获知程序是否有对应权限 | 是否具有权限 |
| infoCollect(pid)          | 收集程序信息并写入日志                                      |              |
| infoReturn(rslt)          | 返回程序执行结果并写入日志                                  |              |
| hackCreat                 | **系统调用重载**：创建文件权限检查                          |              |
| hackRead                  | **系统调用重载**：读取文件权限检查                          |              |
| hackWrite                 | **系统调用重载**：写入文件权限检查                          |              |
| hackChmod                 | **系统调用重载**：文件权限改变权限检查                      |              |
| hackGethostid             | **系统调用重载**：获取主机标识符权限检查                    |              |

*系统调用重载函数的接口定义参照linux内核本身定义

## 数据结构定义

约定接口数据结构

- 1*：动作执行的结果，编码为int类型
  -  0：动作执行成功
  - -1：出错（默认）